<!DOCTYPE html>
<html>
	
<!-- Mirrored from jwc.swjtu.edu.cn/service/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 May 2021 13:50:53 GMT -->
<head>
		<title>用户登录-VATUU为途教学信息服务平台</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" >
		<meta name="keywords" content="VATUU,为途,教学信息服务平台,教务管理系统,教务网,教务系统" />
		<meta name="description" content="VATUU为途，专注于高等教育信息化，中国领先的教学信息化解决方案服务商" />
		<link rel="stylesheet" href="../css/usersys/dean.css" />
		<style>
        .inp {
            border: 1px solid #cccccc;
            border-radius: 2px;
            padding: 0 10px;
            width: 278px;
            height: 40px;
            font-size: 18px;
        }
        .btn {
            border: 1px solid #cccccc;
            border-radius: 2px;
            width: 100px;
            height: 40px;
            font-size: 16px;
            color: #666;
            cursor: pointer;
            background: white linear-gradient(180deg, #ffffff 0%, #f3f3f3 100%);
        }
        .btn:hover {
            background: white linear-gradient(0deg, #ffffff 0%, #f3f3f3 100%)
        }
        #captcha1,
        #captcha2 {
            width: 300px;
            display: inline-block;
        }
        .show {
            display: block;
        }
        .hide {
            display: none;
        }
        #notice1,
        #notice2 {
            color: red;
            margin:0px;
        }
        label {
            vertical-align: top;
            display: inline-block;
            width: 80px;
            text-align: right;
        }
        #wait1, #wait2 {
            text-align: left;
            color: #666;
            margin: 0;
        }
        .phcolor{ color:#999;}
        .mb10px{margin-bottom: 10px;}
        .login-btn-sso{width: 100%; height: 38px; line-height: 38px; font-size: 15px; text-align: center; background: #4EB73C; border: 1px solid #4EB73C; border-radius: 5px; color: #fff; cursor: pointer;}
        </style>
	</head>
	<body>
		<div class="loadingDiv" style="display:none"></div>
		<div class="bg-box">
			<div class="header-box">
				<div class="main-box clearfix">
					<div class="left-box">
						<a href="../index.html">教务首页</a>
					</div>
					<ul class="right-box">
						<li style="border:none; padding: 0;"><a href="forgot.html">忘记密码？</a></li>
						<li><a href="regist.html">用户注册 </a></li>
						<li><a href="problem.html">无法登录？</a></li>
					</ul>
				</div>
			</div>
			<div class="login-box">
				<div class="main-box clearfix">
					<div class="img-box">
						<img src="../images/usersys/img/login_title.png"/>
					</div>
					<div class="login-form">
					<form id="LoginForm" style="width:300px;">
					
						<h4>VATUU为途教学信息服务</h4>
						<div class="center-box">
							<div class="mb10px"><input type="hidden" name="area" id="area" value="">
							<!--<input type="text" name="geetest_challenge" id="geetest_challenge" value="">
							<input type="text" name="geetest_validate" id="geetest_validate" value="">
							<input type="text" name="geetest_seccode" id="geetest_seccode" value="">-->
								<input type="text" name="username" id="username" class="input-box-1" placeholder="学号/工号"  />
							</div>
							<div class="mb10px">
								<input type="password" name="password" id="password" class="input-box-2" placeholder="输入登录密码" />
							</div>
							<div class="mb10px" style="height:38px;" >
								<input type="text" name="ranstring" id="ranstring"  placeholder="输入验证码" style="float:left;width: 150px; height: 38px;  line-height: 38px; [;line-height: 1px;] font-size: 14px; padding-left: 10px; border: 1px solid #bcbcbc; border-radius: 5px; box-sizing: border-box; " />
								<span id="randomPhoto" style="float:left; height:38px; margin-left:10px;"><img src="#" border=0 height="35" width="100" onclick="javascript:getPhotoAgain()"><a href="javascript:getPhotoAgain()"><font color=blue><u>(更换)</u></font></a></span>
							</div>
							<div class="mb10px" >
								<button class="login-btn" type="button" id="submit2" onclick="loginRanstringSubmit()">登录系统</button>
							</div>
							<div class="mb20px">
								<button class="login-btn-sso" type="button" id="submit21" onclick="window.location='../vatuu/UserLoginForWiseduAction.html'">使用学校统一账号登录（校内用户推荐）</button>
							</div>
							<div class="mb20px clearfix">
								<div class="bar-box"><span class="left-bar"></span>您还没有账号？<span class="left-bar"></span></div>
								<input type="button" class="regist-btn-login" value="账号注册" onclick="window.location='regist.html'">
							</div>
							<div class="btm-box clearfix">
								<div class="find-pwd-box"><a href="forgot.html">忘记密码</a></div>
								<div class="login-help"><a href="checkBrowser.html" target=_blank>请使用谷歌Chrome浏览器，点击下载</a></div>
								
		
							</div>
						</div>
					</form>
					</div>
				</div>
			</div>
			<div class="footer-box">
				<p>图片来源：<span>VATUU</span><span>为途</span> <button class="upload-pic-btn"> <i class="upload-pic-icon"></i> 我要上传图片</button></p>
		
			</div>
		</div>
		<form name="loading" id="loading" method=post action="http://jwc.swjtu.edu.cn/vatuu/UserLoadingAction">
		    <input type="hidden" name="url" id="url" value=""  />
			<input type="hidden" name="returnUrl" id="returnUrl" value=""  />
			<input type="hidden" name="returnType" id="returnType" value=""  />
			<input type="hidden" name="loginMsg" id="loginMsg" value="">
		</form>
		
<script src="../js/jquery/1.12.4/jquery.js"></script>
<script src="../js/jquery/cookie/jquery.cookie.js"></script>
<script src="../js/validation/jquery.validate.min.js"></script> 
<script src="../js/validation/messages_zh.js"></script>
<!--  <script src="http://api.map.baidu.com/api?v=2.0&ak=lGpNChd9F632HmQ8TI8BPkFzGzEisIYm&callback=initialize"></script>-->
<script>
   var thisUrl = window.location.href;
   if(thisUrl.indexOf("dean.vatuu.com")>-1){
       window.location="login.html";
   }
   
   var fromurl=document.referrer;
   var seturl=getQueryString("url");
   var returnType=getQueryString("returnType");
   var returnUrl=getQueryString("returnUrl");
   if(seturl!=null&&seturl.length>1){
	   fromurl=seturl;
   }
   $().ready(function() {
        var username=$.cookie('username');
        
        //alert(returnUrl);
        $('#url').val(fromurl);
        $('#returnUrl').val(returnUrl);
		$('#username').val(username);
		$('#returnType').val(returnType);
		//判断浏览器版本
		var browser=getBroInfo();
		if(browser != undefined&&browser.length>0){
		    browser=browser.toLowerCase();
		    if(browser.indexOf("ie") >-1||browser.indexOf("兼容") >-1){
		       ret=confirm("为了更好的使用本系统，我们推荐您使用谷歌Chrome浏览器！\n您需要继续访问吗？点击取消将转入浏览器下载页面");
		       if(!ret){
		          window.location.href="checkBrowser.html";
		       }
		       
		    }
		}
		/*
   		//判断版本号 
   		var browser = getBrowserInfo() ;//浏览器信息
		var verinfo = (browser+"").replace(/[^0-9.]/ig,""); 
		var version ="";//版本号
		//alert(browser);
		if(browser != undefined){
			var bigVersion = verinfo.split(".");
			version = parseInt(bigVersion[0]);
			if(browser[0].indexOf("msie") >-1 && version < 9){
				window.location.href="./checkBrowser.html";
			}else{
				if(version != ""){
					if(browser[0].indexOf("msie") >-1 && version < 10){
						//低版本ie placeholder兼容
						$("#username").val($("#username").attr("placeholder"));
						$("#username").blur(function(){
							if($(this).val() == ""){
								$(this).val($("#username").attr("placeholder"));
							}
						})
					}
				}
			}
		}
		*/
		$("#LoginForm").validate({
			/*onfocusout:false,
			onkeyup:false,
			onclick:false,*/
			rules: {
				username: {
					required: true,
					minlength: 4
				},
				password: {
					required: true,
					minlength: 6
				}
			},
			messages: {
				username: {
					required: "请输入用户名",
					minlength: "用户名不少于4位"
				},
				password: {
					required: "请输入密码",
					minlength: "密码不少于6位"
				}
			}
		});
		
		new getPhotoAgain();
	});
	
	/*
	$.ajax({
        url: "../vatuu/StartCaptchaServlet?t=" + (new Date()).getTime(), // 加随机数防止缓存
        type: "get",
        dataType: "json",
        success: function (data) {
            // 调用 initGeetest 初始化参数
            var userType=data.userType;
            var universityId=data.universityId;
            var checkPower=data.checkPower;
            if(userType.length>0&&universityId.length>0&&checkPower.length>0){
                window.location="../vatuu/UserLoadingAction";
            }
            else{
            // 参数1：配置参数
            // 参数2：回调，回调的第一个参数验证码对象，之后可以使用它调用相应的接口
            initGeetest({
                gt: data.gt,
                challenge: data.challenge,
                new_captcha: data.new_captcha, // 用于宕机时表示是新验证码的宕机
                offline: !data.success, // 表示用户后台检测极验服务器是否宕机，一般不需要关注
                product: "popup", // 产品形式，包括：float，popup
                width: "100%"
            }, handler2);
            }
            
        }
    });
    */
	//定位
	/*
	function initialize() {
		 var geolocation = new BMap.Geolocation();
			geolocation.getCurrentPosition(function(r){
				if(this.getStatus() == BMAP_STATUS_SUCCESS){
					//coordinates = '经度：'+r.point.lng+',纬度：'+r.point.lat;
			        //city = r.address.province+r.address.city;
			        document.getElementById("area").value=r.address.province+r.address.city;
				}
				else {
					//coordinates = "";
					//city = "";
					document.getElementById("area").value="定位失败";
				}        
			},{enableHighAccuracy: true});
	}
	window.onload = initialize; 
	*/
    
    //获取浏览器信息
    function getBrowserInfo(){
		var agent = navigator.userAgent.toLowerCase() ;
		//var agent = window.navigator.userAgent.toLowerCase();
		//alert(agent);
		var regStr_ie = /msie [\d.]+;/gi ;
		var regStr_ff = /firefox\/[\d.]+/gi
		var regStr_chrome = /chrome\/[\d.]+/gi ;
		var regStr_saf = /safari\/[\d.]+/gi ;
		//IE
		if(agent.indexOf("msie") > -1)
		{
		return agent.match(regStr_ie) ;
		}
		
		//firefox
		if(agent.indexOf("firefox") > -1)
		{
		return agent.match(regStr_ff) ;
		}
		
		//Chrome
		if(agent.indexOf("chrome") > -1)
		{
		return agent.match(regStr_chrome) ;
		}
		
		//Safari
		if(agent.indexOf("safari") > -1 && agent.indexOf("chrome") <0)
		{
		return agent.match(regStr_saf) ;
		}
		
	}
	
	//获取浏览器版本
	function getBroInfo(){
        
	    var is360 = false;
		var isIE = false;
		var isFirefox = false;
		var isChrome = false;
		var isEdge = false;
		var broName = 'Runing';
		var str = '';
		var strStart = 0;
		var strStop = 0;
		var arr = new Array();
		var temp = '';

		var userAgent = window.navigator.userAgent; //包含以下属性中所有或一部分的字符串：appCodeName,appName,appVersion,language,platform

		/*alert(userAgent);*/
		//FireFox
		if (userAgent.indexOf('Firefox') != -1) {
			isFireFox = true;
			/*broName = 'FireFox浏览器';*/
			strStart = userAgent.indexOf('Firefox');
			temp = userAgent.substring(strStart);
			broName = temp.replace('../index-2.html', '版本号')

		}

		//Edge
		if (userAgent.indexOf('Edge') != -1) {
			isEdge = true;
			/*broName = 'Edge浏览器';*/
			strStart = userAgent.indexOf('Edge');
			temp = userAgent.substring(strStart);
			broName = temp.replace('../index-2.html', '版本号');
		}

		//IE浏览器
		if (userAgent.indexOf('NET') != -1 && userAgent.indexOf("rv") != -1) {
			isIE = true;
			/*broName = 'IE浏览器'; */
			strStart = userAgent.indexOf('rv');
			strStop = userAgent.indexOf(')');
			temp = userAgent.substring(strStart, strStop);
			broName = temp.replace('rv', 'IE').replace(':', '版本号');
		}

		//360极速模式可以区分360安全浏览器和360极速浏览器
		if (userAgent.indexOf('WOW') != -1 && userAgent.indexOf("NET") < 0
				&& userAgent.indexOf("Firefox") < 0) {
			if (navigator.javaEnabled()) {
				is360 = true;
				broName = '360安全浏览器-极速模式';
			} else {
				is360 = true;
				broName = '360极速浏览器-极速模式';
			}
		}

		//360兼容
		if (userAgent.indexOf('WOW') != -1 && userAgent.indexOf("NET") != -1
				&& userAgent.indexOf("MSIE") != -1
				&& userAgent.indexOf("rv") < 0) {
			is360 = true;
			broName = '360兼容模式';
		}

		//Chrome浏览器
		if (userAgent.indexOf('WOW') < 0 && userAgent.indexOf("Edge") < 0) {
			isChrome = true;
			/*broName = 'Chrome浏览器';*/
			strStart = userAgent.indexOf('Chrome');
			strStop = userAgent.indexOf(' Safari');
			temp = userAgent.substring(strStart, strStop);
			broName = temp.replace('../index-2.html', '版本号');

		}
		return broName;
	}
	
	function getQueryString(name) {
       var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
       var r = window.location.search.substr(1).match(reg);
       if (r != null) return unescape(r[2]); return null;
    }
	
	function getPhotoAgain(){
	    document.getElementById("randomPhoto").innerHTML="<img src=../vatuu/GetRandomNumberToJPEG?test="+new Date().getTime()+" border=0 height=35 width=100 onclick=\"javascript:getPhotoAgain()\"><a href=\"javascript:getPhotoAgain()\"><font color=blue><u>(更换)</u></font></a>";
        //photoText.innerHTML="<img src=../vatuu/GetRandomNumberToJPEG?test="+new Date().getTime()+" border=0 height=22 width=60 >";
    }
    
    function loginRanstringSubmit(){
       var username=$("#username").val();
       var password=$("#password").val();
       var ranstring=$("#ranstring").val();
       if(username==null||username.length<4){
           alert("请输入学号或工号");
       }else{
          if(password==null||password.length<6){
              alert("请输入密码且不少于6位");
          }else{
             if(ranstring==null||ranstring.length<4){
                 alert("请输入验证码，不区分大小写");
             }else{
                 $.ajax({
	                    url: '../vatuu/UserLoginAction',
	                    type: 'POST',
	                    dataType: 'json',
	                    data: {
	                        username: username,
	                        password: password,
	                        url: $('#url').val(),
	                        returnType: $('#returnType').val(),
	                        returnUrl: $('#returnUrl').val(),
	                        area: $('#area').val(),
	                        ranstring: ranstring
	                    },
	                    success: function (data) {
	                        if (data.loginStatus === '1') {
	                            //alert(data.loginMsg);
	                            $('#loginMsg').val(data.loginMsg);
                           		$('#loading').submit();
	                        }
	                        //else if(data.loginStatus === '-2'){
	                        //    alert(data.loginMsg);
	                        //    getPhotoAgain();
	                        //}
	                        else{
	                            alert(data.loginMsg);
	                            getPhotoAgain();
	                        }
	                    }
	                });
             }
          }
       }
       
       //return false;
    
    }
    
    //百度统计
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "../../hm.baidu.com/hm6148.js?87cf2c3472ff749fe7d2282b7106e8f1";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>

<!-- Mirrored from jwc.swjtu.edu.cn/service/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 May 2021 13:50:56 GMT -->
</html>